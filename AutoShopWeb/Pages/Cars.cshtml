@page
@model AutoShopWeb.Pages.CarsModel
@{
    ViewData["Title"] = "Автомобили";
}

<div class="d-flex align-items-center justify-content-between mb-3">
    <h2 class="mb-0">Автомобили</h2>
</div>

<form method="get" class="card shadow-sm mb-3">
    <div class="card-body">
        <div class="row g-2 align-items-end">
            <div class="col-md-4">
                <label class="form-label">Поиск (модель)</label>
                <input class="form-control" name="q" value="@Model.Q" placeholder="например: Camry, BMW, Solaris" />
            </div>

            <div class="col-md-2">
                <label class="form-label">Год от</label>
                <input class="form-control" name="yearFrom" type="number" value="@(Model.YearFrom?.ToString() ?? "")" />
            </div>
            <div class="col-md-2">
                <label class="form-label">Год до</label>
                <input class="form-control" name="yearTo" type="number" value="@(Model.YearTo?.ToString() ?? "")" />
            </div>

            <div class="col-md-2">
                <label class="form-label">Цена от</label>
                <input class="form-control" name="priceFrom" type="number" step="0.01" value="@(Model.PriceFrom?.ToString() ?? "")" />
            </div>
            <div class="col-md-2">
                <label class="form-label">Цена до</label>
                <input class="form-control" name="priceTo" type="number" step="0.01" value="@(Model.PriceTo?.ToString() ?? "")" />
            </div>

            <div class="col-md-3">
                <label class="form-label">Статус</label>
                <select class="form-select" name="status">
                    <option value="" selected="@(string.IsNullOrEmpty(Model.Status))">(любой)</option>
                    <option value="В наличии" selected="@(Model.Status == "В наличии")">В наличии</option>
                    <option value="Продан" selected="@(Model.Status == "Продан")">Продан</option>
                    <option value="Зарезервирован" selected="@(Model.Status == "Зарезервирован")">Зарезервирован</option>
                    <option value="На сервисе" selected="@(Model.Status == "На сервисе")">На сервисе</option>
                </select>
            </div>

            <div class="col-md-3">
                <label class="form-label">Сортировка</label>
                <select class="form-select" name="sort">
                    <option value="model" selected="@(Model.Sort == "model")">Модель (А-Я)</option>
                    <option value="price_asc" selected="@(Model.Sort == "price_asc")">Цена ↑</option>
                    <option value="price_desc" selected="@(Model.Sort == "price_desc")">Цена ↓</option>
                    <option value="year_desc" selected="@(Model.Sort == "year_desc")">Год ↓</option>
                    <option value="mileage_asc" selected="@(Model.Sort == "mileage_asc")">Пробег ↑</option>
                </select>
            </div>

            <div class="col-md-3">
                <button class="btn btn-primary w-100" type="submit">Применить</button>
            </div>

            <div class="col-md-3">
                <a class="btn btn-outline-secondary w-100" href="/Cars">Сброс</a>
            </div>
        </div>
    </div>
</form>

<div class="text-muted mb-2">Найдено: <b>@Model.Total</b></div>

<table class="table table-striped table-hover align-middle">
    <thead>
        <tr>
            <th>Модель</th>
            <th>Год</th>
            <th>Пробег</th>
            <th>Цена</th>
            <th>Статус</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var c in Model.Cars)
        {
            <tr>
                <td>@c.Model</td>
                <td>@c.ReleaseYear</td>
                <td>@c.Mileage</td>
                <td>@c.Price</td>
                <td>
                    <span class="badge @(c.Status=="В наличии" ? "bg-success" :
                                                                  c.Status == "Продан" ? "bg-secondary" :
                                                                  c.Status == "Зарезервирован" ? "bg-warning text-dark" :
                                                                  "bg-info text-dark")">
                        @c.Status
                    </span>
                </td>
            </tr>
        }
    </tbody>
</table>
