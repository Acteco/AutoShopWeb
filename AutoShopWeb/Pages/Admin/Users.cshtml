@page
@model AutoShopWeb.Pages.Admin.UsersModel
@attribute [Microsoft.AspNetCore.Authorization.Authorize(Roles="Admin")]
@{
    ViewData["Title"] = "Пользователи";
}

<h2 class="mb-3">Пользователи</h2>

@if (!string.IsNullOrWhiteSpace(Model.Message))
{
  <div class="alert alert-info">@Model.Message</div>
}

<table class="table table-striped table-hover align-middle">
  <thead>
    <tr>
      <th>ID</th><th>Login</th><th>Role</th><th>Active</th><th>Created</th><th>Last Login</th><th></th>
    </tr>
  </thead>
  <tbody>
  @foreach (var u in Model.Users)
  {
    <tr>
      <td>@u.UserId</td>
      <td>@u.Login</td>
      <td>@u.RoleName</td>
      <td>@(u.IsActive ? "Да" : "Нет")</td>
      <td>@u.CreatedAt</td>
      <td>@u.LastLoginAt</td>
      <td class="text-end">
        @if (u.IsActive)
        {
          <form method="post" asp-page-handler="Disable" class="d-inline">
            <input type="hidden" name="id" value="@u.UserId" />
            <button class="btn btn-sm btn-outline-danger">Отключить</button>
          </form>
        }
        else
        {
          <form method="post" asp-page-handler="Enable" class="d-inline">
            <input type="hidden" name="id" value="@u.UserId" />
            <button class="btn btn-sm btn-outline-success">Включить</button>
          </form>
        }
      </td>
    </tr>
  }
  </tbody>
</table>
