@page
@model AutoShopWeb.Pages.Employee.Payments.IndexModel
@attribute [Microsoft.AspNetCore.Authorization.Authorize(Roles = "Employee,Admin")]
@{
    ViewData["Title"] = "Оплаты по договору";
}

<div class="d-flex align-items-center justify-content-between mb-3">
    <div>
        <h2 class="mb-0">Оплаты</h2>
        @if (Model.ContractNumber > 0)
        {
            <div class="text-muted">Договор №@Model.ContractNumber</div>
        }
    </div>

    <div class="d-flex gap-2">
        @if (Model.ContractNumber > 0)
        {
            <a class="btn btn-primary" href="/Employee/Payments/Create?contractNumber=@Model.ContractNumber">Добавить оплату</a>
        }
        <a class="btn btn-outline-secondary" href="/Employee/Contracts">К договорам</a>
    </div>
</div>

@if (!string.IsNullOrWhiteSpace(Model.Error))
{
    <div class="alert alert-danger">@Model.Error</div>
}

@if (!string.IsNullOrWhiteSpace(Model.ContractInfo))
{
    <div class="alert alert-light border">
        <b>Договор:</b> @Model.ContractInfo
    </div>
}

<table class="table table-striped table-hover align-middle">
    <thead>
        <tr>
            <th>ID</th>
            <th>Дата</th>
            <th>Сумма</th>
            <th>Статус</th>
            <th>Способ</th>
            <th class="text-end">Действия</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var p in Model.Items)
        {
            <tr>
                <td>@p.PaymentId</td>
                <td>@p.PayDate</td>
                <td>@p.Amount</td>
                <td>@p.Status</td>
                <td>@p.PaymentMethod</td>
                <td class="text-end">
                    <a class="btn btn-sm btn-outline-primary" href="/Employee/Payments/Edit?id=@p.PaymentId">Изменить</a>
                </td>
            </tr>
        }
    </tbody>
</table>
